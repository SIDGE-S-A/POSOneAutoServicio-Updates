name: Deploy Updates to Surge

on:
    repository_dispatch:
        types: [deploy-from-main]

jobs:
    deploy:
        runs-on: ubuntu-latest

        steps:
            - name: ðŸ“¦ Checkout updates repo
              uses: actions/checkout@v4
            - name: ðŸ§© Debug acceso a release
              run: |
                curl -H "Authorization: token ${{ secrets.GH_TOKEN }}" \
                    https://api.github.com/repos/SIDGE-S-A/POSOneAutoServicio/releases/latest
            - name: ðŸ§© Descargar assets del release principal
              uses: robinraju/release-downloader@v1.10
              with:
                repository: SIDGE-S-A/POSOneAutoServicio
                latest: true
                out-file-path: ./public
              env:
                GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}


            - name: ðŸš€ Deploy to Surge
              run: |
                  npm install -g surge
                  surge ./public posoneauto-updates.surge.sh --token ${{ secrets.SURGE_TOKEN }}
